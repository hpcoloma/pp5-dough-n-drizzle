{% extends "base.html" %}
{% load static %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'profiles/css/profile.css' %}">
{% endblock %}

{% block page_header %}
    <div class="container header-container">
        <div class="row">
            <div class="col"></div>
        </div>
    </div>
{% endblock %}

{% block content %}
    <div class="overlay"></div>
    <div class="container-fluid px-3 mb-2 content-container">
        <div class="row">
            <div class="col">
            </div>
        </div>
        <div class="row">
            <div class="col-sm-2">
                <ul class="list-group">
                    <li class="list-group-item">
                        <a href="{% url 'add_product' %}" class="admin-menu-link" data-target="#admin-container" data-type="product">Product Management</a>
                    </li>
                    <li class="list-group-item">
                        <a href="{% url 'discount_list' %}" class="admin-menu-link" data-target="#admin-container" data-type="discount">Discounts</a>
                    </li>
                    <li class="list-group-item">
                        <a href="" class="admin-menu-link" data-target="#admin-container" data-type="gift">Gift Cards</a>
                    </li>
                    <li class="list-group-item">
                        <a href="" class="admin-menu-link" data-target="#admin-container" data-type="testimonial">Testimonials</a>
                    </li>
                </ul>
            </div>
            <div class="col-sm-10" id="admin-container">
                <!-- This is where the content will be loaded dynamically -->
            </div>
        </div>
    </div>
{% endblock %}
{% block postloadjs %}
<script>
    $(document).ready(function() {
        // Load the add_product page on initial load
        var defaultUrl = "{% url 'add_product' %}";
        $('#admin-container').load(defaultUrl, function(response, status, xhr) {
            if (status == "error") {
                $('#admin-container').html('<p>Error loading content. Please try again.</p>');
            } else {
                // Reinitialize Bootstrap dropdowns after the initial load
                reinitializeBootstrap();
            }
        });

        // Handle click events for admin menu links
        $('.admin-menu-link').on('click', function(e) {
            e.preventDefault(); // Prevent the default link behavior

            var url = $(this).attr('href'); // Get the URL from the link
            var target = $(this).data('target'); // Get the target container

            // Load the content into the admin-container
            $(target).load(url, function(response, status, xhr) {
                if (status == "error") {
                    // Handle error
                    $(target).html('<p>Error loading content. Please try again.</p>');
                } else {
                    // Reinitialize Bootstrap dropdowns after content is loaded dynamically
                    reinitializeBootstrap();
                }
            });
        });

        // Function to reinitialize Bootstrap components after content is dynamically loaded
        function reinitializeBootstrap() {
            // Reinitialize Bootstrap dropdowns
            $('[data-toggle="dropdown"]').dropdown();
        }
    });
</script>
{% endblock %}